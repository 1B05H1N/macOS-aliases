# This file should be located in modules/pentest_aliases.sh as per the recommended structure.
# pentest_aliases.sh - Security / Pentesting aliases
# These aliases are only defined if the tool is installed (checked with 'command -v').
# Uncomment or add more as you install new tools. This keeps your shell error-free and portable.

# Nmap (brew install nmap)
if command -v nmap &>/dev/null; then
  alias nmapS='nmap -sS -Pn -T4'
  alias nmapFull='nmap -sC -sV -A -Pn -T4'
  alias nmapTop='nmap --top-ports 1000 -sV -Pn -T4'
fi

# Masscan (brew install masscan)
if command -v masscan &>/dev/null; then
  alias masscanFast='sudo masscan -p1-65535 --rate=10000'
  alias masscanWeb='sudo masscan -p80,443,8080 --rate=5000'
fi

# Subdomain enumeration (brew install amass subfinder assetfinder)
if command -v amass &>/dev/null && command -v subfinder &>/dev/null && command -v assetfinder &>/dev/null; then
  subenum() {
    amass enum -passive -d "$1"
    subfinder -silent -d "$1"
    assetfinder --subs-only "$1"
  }
  alias subfinder='subfinder -silent -d'
  alias amassEnum='amass enum -passive -d'
  alias assetfinder='assetfinder --subs-only'
fi

# HTTP probing & screenshots
if command -v httpx &>/dev/null; then
  alias httpx='httpx -silent -mc 200,201,204,301,302,307'
fi
if command -v aquatone &>/dev/null; then
  alias aquatone='aquatone -silent -out aquatone_report'
fi

# Directory & content discovery
if command -v ffuf &>/dev/null; then
  alias ffuf='ffuf -c -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u'
fi
if command -v gobuster &>/dev/null; then
  alias gobusterdir='gobuster dir -u'
fi

# Vulnerability scanners
if command -v nikto &>/dev/null; then
  alias nikto='nikto -h'
fi
if command -v sqlmap &>/dev/null; then
  alias sqlmap='sqlmap -u --batch'
fi

# Password attacks
if command -v hydra &>/dev/null; then
  alias hydraSSH='hydra -t 4 -L users.txt -P passwords.txt ssh://'
fi
if command -v john &>/dev/null; then
  alias johnRock='john --wordlist=/usr/share/wordlists/rockyou.txt'
fi
if command -v hashcat &>/dev/null; then
  alias hashcat0='hashcat -m 0 -a 0'
fi

# Proxychains / Tor
if command -v proxychains4 &>/dev/null; then
  alias proxychains='proxychains4'
fi

# Misc pentest helpers
if command -v wfuzz &>/dev/null; then
  alias wfuzz='wfuzz -c -z file,/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u'
fi
alias cronenum='curl -s https://crt.sh/?q=%.$1 | grep "<TD>" | sed "s/<[^>]*>//g"'
alias jsfinder='grep -R "http.*\.js" -o'

# Burp Suite
if [[ -d "/Applications/BurpSuiteProfessional.app" ]]; then
  alias burp='open /Applications/BurpSuiteProfessional.app'
fi

# Bonus: CrackMapExec, Metasploit, ffmpeg
if command -v crackmapexec &>/dev/null; then
  alias cme='crackmapexec --verbose'
fi
if command -v msfconsole &>/dev/null; then
  alias msf='msfconsole'
fi
if command -v ffmpeg &>/dev/null; then
  alias ffmpeginfo='ffmpeg -hide_banner -i'
fi

# Additional pentest aliases inspired by zsh-pentest

# Whois lookup (brew install whois)
if command -v whois &>/dev/null; then
  alias w='whois'
fi

# DNS lookup (brew install bind for dig)
if command -v dig &>/dev/null; then
  alias d='dig +short'
fi

# HTTP requests (brew install httpie)
if command -v http &>/dev/null; then
  alias httpget='http GET'
  alias httppost='http POST'
fi

# Quick web server (Python 3)
if command -v python3 &>/dev/null; then
  alias serve='python3 -m http.server'
fi

# Download with wget or curl
if command -v wget &>/dev/null; then
  alias wgetc='wget --continue'
fi
if command -v curl &>/dev/null; then
  alias curlh='curl -I'
fi

# Hashing (md5sum or md5)
if command -v md5sum &>/dev/null; then
  alias md5='md5sum'
elif command -v md5 &>/dev/null; then
  alias md5='md5'
fi

# Hexdump (macOS: hexdump is built-in)
if command -v hexdump &>/dev/null; then
  alias xxd='hexdump -C'
  alias hexview='hexdump -C'
fi

# Base64 encode/decode (macOS: base64 is built-in)
if command -v base64 &>/dev/null; then
  alias b64e='base64'
  alias b64d='base64 -d'
fi

# Quick port scan with bash and nc (macOS: nc is built-in)
if command -v nc &>/dev/null; then
  portscan() { for port in {1..1024}; do nc -zv "$1" $port 2>&1 | grep succeeded; done; }
fi

# Quick reverse shell (for CTFs, use with caution)
revshell() { nc -lvnp "$1"; }

# Quick HTTP server with PHP (if installed)
if command -v php &>/dev/null; then
  alias phpsrv='php -S 0.0.0.0:8000'
fi

# Quick Python web server (Python 2)
if command -v python &>/dev/null; then
  alias serve2='python -m SimpleHTTPServer'
fi

# Quick ncat listener (brew install nmap)
if command -v ncat &>/dev/null; then
  alias nclisten='ncat -lvnp'
fi

# Quick string search in binaries
alias sbin='strings'

# Quick check for open ports (macOS: lsof is built-in)
alias openports='lsof -i -P -n | grep LISTEN' 